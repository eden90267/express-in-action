# chap12. 最佳實踐

>**本章涵蓋**  
>簡化你代碼的好處  
>結構化你的app文件  
>使用`npm shrinkwrap`命令來鎖定可靠的依賴項版本(以及這樣做的好處)  
>避免全局模組的安裝

## 簡潔

很多維護大型代碼庫的最佳實踐，歸納為一件事情：簡潔。你的代碼應該是易於其他開發者觀看的，你需要盡量的減少一個人所要記住的上下文。

為了理解Express，你做了很多的了解：

- 為了閱讀代碼，你理應對Javascript編程語言十分的了解
- 你必須了解HTTP的工作方式而對路由進行理解
- 你必須了解Node以及它的事件I/O
- 你必須了解Express的路由、中間件、視圖，以及它的特性

應用程式應該盡可能少的引入一大堆需要了解的東西。

透過這兩個方法可以看看你代碼的兔子洞到底有多深：

- 查看你的一段代碼──可以是一個路由處理或是中間件函數──然後詢問自己需要多少的額外知識才能了解這段代碼。
- 跟你一起的開發人員有多困惑? 他們為你的app添加一個特性需要多久?如果他們覺得很困惑且不能快速的工作，這就意味著你的代碼有點太複雜了。

你必須嚴格的做到簡潔。我們將在本章討論一些方法。

## 文件結構模式

![](http://i.imgur.com/MlOChi8.png)

這些是一個Express應用程序結構中常見的文件：

- package.json
- app.js編寫我們應用程序的重要代碼─入口點。在這裡你調用express()來實例化一個Express應用程序。這裡同樣也放置所有路由的通用中間件，例如安全中間件和靜態文件中間件。如你所見，**這個文件並不會啟動app**─它只是將app分配到了`module.exports`。
- bin文件夾存放了你應用程序的所有可執行腳本。裡面通常只會有一個文件，但有時會引入更多。

    bin/www是一個可執行的Node腳本，它(從app.js)`require`了你的app並啟動它。並在調用`npm start`的時候運行這個腳本。

- config是一個包含你app所有配置的文件夾。裡面通常會有很多的JSON文件，這些文件通常會指定一些默認端口號或本地化字符串這樣的東西。
- public是一個用於給靜態文件中間件服務的文件夾。裡面將會存放任何類型的靜態文件─HTML頁面、text文件、圖片、視頻等等。這個靜態文件中間件同樣可以提供一些公共文件夾。例如，[https://html5boilerplate.com/](https://html5boilerplate.com/)中的HTML 5 Boilerplate，提供一個很好的選擇，你可以在這裡添加常規的靜態文件。
- routes文件夾存放眾多的JavaScript文件，每一個文件都輸出了一個Express的Router。

    你可能有一個用來處理所有以/users開頭的URL Router，或另一個用來處理所有以/photos開頭的URL Router。

- test文件夾存放了你所有的測試代碼。
- views文件夾存放你所有的視圖文件。

一個查看這種文件組織方式優勢的最後方法就是，使用官方的Express應用程序生成器，你可利用npm i -g express-generator來進行安裝。一旦你安裝了她，你就可以運行express my-new-app，它就會創建一個my-express-app文件夾並在裡面設置app骨架。

這樣的模式和慣例會很常見。